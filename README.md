# RAZIGAM
This is a working repo for Yunyi's ecological modeling idea: Repeated Sampling Zero Inflated Generalized Additive Models. The idea is when there exist imperfect detection of the data, say counting number of birds/presence of tigers, meanwhile, not all spots are occupied by certain birds, which cause zero inflate, we need to model theses factors at the same time.

The main function ZIGAM.R consists of 2 functional parts. A GAM version Zero-Inflated N-mixture Model and a GAM version of single species Occupancy model. The main algorithm generally follows the EM and modified PIRLS method suggested by R package [COZIGAM](https://www.jstatsoft.org/article/view/v035i11/0) , (Hai Liu and Kung-Sik Chan 2010). The EM-PIRLS will iterate until converge.

For the zero inflated N-mixture model, instead of using traditional linear regression strategy, here we use GAM version of all process including occupancy, latent lambda and detection probabilities. By adding one more EM step for the main Poisson-Binomial distribution we can deal with the missing observation of occupancy and latent n at the same time. Three GAMs for psi, lambda and p are fitted with "pseudo-data" generated from Estep of the EM algorithm  and coupled usint the modified PIRLS. Though the point estimation of parameters comes from MPLE, the CI adopts a Bayesian frame work, follow the Laplacian approximation suggested by COZIGAM paper.

For the GAM-occupancy model, since the process is much simpler (no latent lambda), the algorithm of COZIGAM can be directly used to obtain the point estimation of parameters, but CI also adopts the Bayesian-Laplacian approximation approach.